{% extends 'base.html' %}

{% block title %}대시보드 - WBS 프로젝트 관리{% endblock %}

{% block page_title %}대시보드{% endblock %}

{% block content %}
<!-- Project Stats Container -->
<div class="project-stats-container">
    <div class="project-stats-grid">
        <div class="project-stat-item">
            <div class="project-stat-number">{{ total_projects }}</div>
            <div class="project-stat-label">전체 프로젝트</div>
            <div class="project-progress-bar">
                <div class="project-progress-fill" style="width: 100%;"></div>
            </div>
        </div>
        
        <div class="project-stat-item">
            <div class="project-stat-number">{{ active_projects }}</div>
            <div class="project-stat-label">진행중 프로젝트</div>
            <div class="project-progress-bar">
                <div class="project-progress-fill" style="width: {% if total_projects > 0 %}{{ active_projects|floatformat:0|add:0|mul:100|div:total_projects }}{% else %}0{% endif %}%;"></div>
            </div>
        </div>
        
        <div class="project-stat-item">
            <div class="project-stat-number">{{ completed_projects }}</div>
            <div class="project-stat-label">완료된 프로젝트</div>
            <div class="project-progress-bar">
                <div class="project-progress-fill" style="width: {% if total_projects > 0 %}{{ completed_projects|floatformat:0|add:0|mul:100|div:total_projects }}{% else %}0{% endif %}%;"></div>
            </div>
        </div>
        
        <div class="project-stat-item">
            <div class="project-stat-number">{{ pending_approvals }}</div>
            <div class="project-stat-label">대기중 승인</div>
            <div class="project-progress-bar">
                <div class="project-progress-fill" style="width: {% if total_projects > 0 %}{{ pending_approvals|floatformat:0|add:0|mul:100|div:total_projects }}{% else %}0{% endif %}%;"></div>
            </div>
        </div>
    </div>
</div>

<!-- Main Content Grid -->
<div class="grid grid-cols-2 gap-6">
    <!-- Recent Projects -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-clock" style="margin-right: 0.5rem; color: var(--text-secondary);"></i>
                최근 프로젝트
            </h2>
            <a href="{% url 'wbs:project_list' %}" class="btn btn-secondary btn-sm">
                전체 보기
            </a>
        </div>
        <div class="card-body">
            {% if recent_projects %}
                <div class="space-y-4">
                    {% for project in recent_projects %}
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 rounded-full" style="background-color: {{ project.color_theme }};"></div>
                            <div>
                                <h3 class="font-medium text-gray-900">{{ project.title }}</h3>
                                <p class="text-sm text-gray-500">{{ project.manager.get_full_name|default:project.manager.username }}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-medium text-gray-900">{{ project.progress }}%</div>
                            <div class="text-xs text-gray-500">{{ project.status }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-folder-open text-4xl mb-4"></i>
                    <p>아직 프로젝트가 없습니다.</p>
                    <a href="{% url 'wbs:project_create' %}" class="btn btn-primary mt-4">
                        첫 프로젝트 만들기
                    </a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Pending Approvals -->
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-clock" style="margin-right: 0.5rem; color: var(--text-secondary);"></i>
                승인 대기
            </h2>
            <a href="{% url 'wbs:project_list' %}?status=pending" class="btn btn-secondary btn-sm">
                전체 보기
            </a>
        </div>
        <div class="card-body">
            {% if pending_projects %}
                <div class="space-y-4">
                    {% for project in pending_projects %}
                    <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 rounded-full bg-yellow-400"></div>
                            <div>
                                <h3 class="font-medium text-gray-900">{{ project.title }}</h3>
                                <p class="text-sm text-gray-500">{{ project.manager.get_full_name|default:project.manager.username }}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-medium text-yellow-600">승인 대기</div>
                            <div class="text-xs text-gray-500">{{ project.created_at|date:"m/d" }}</div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-check-circle text-4xl mb-4 text-green-500"></i>
                    <p>승인 대기 중인 프로젝트가 없습니다.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="mt-6">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-bolt" style="margin-right: 0.5rem; color: var(--text-secondary);"></i>
                빠른 작업
            </h2>
        </div>
        <div class="card-body">
            <div class="grid grid-cols-4 gap-4">
                <a href="{% url 'wbs:project_create' %}" class="btn btn-primary">
                    <i class="fas fa-plus mr-2"></i>
                    새 프로젝트
                </a>
                <a href="{% url 'wbs:project_list' %}" class="btn btn-secondary">
                    <i class="fas fa-list mr-2"></i>
                    프로젝트 목록
                </a>
                <a href="{% url 'wbs:calendar' %}" class="btn btn-secondary">
                    <i class="fas fa-calendar mr-2"></i>
                    캘린더
                </a>
                <a href="{% url 'wbs:user_list' %}" class="btn btn-secondary">
                    <i class="fas fa-users mr-2"></i>
                    팀원 관리
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}



