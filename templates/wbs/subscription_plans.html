{% extends 'base.html' %}

{% block title %}구독 플랜 - WBS 프로젝트 관리{% endblock %}

{% block page_title %}구독 플랜{% endblock %}

{% block content %}
<div class="grid grid-cols-1">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">
                <i class="fas fa-crown" style="margin-right: 0.5rem; color: var(--text-secondary);"></i>
                구독 플랜 선택
            </h2>
        </div>
        <div class="card-body">
            {% if user_subscription %}
                <div style="background: var(--sidebar-hover); padding: 1rem; border-radius: 8px; margin-bottom: 2rem; border: 1px solid var(--card-border);">
                    <h3 style="color: var(--text-heading); margin-bottom: 0.5rem;">
                        <i class="fas fa-check-circle" style="color: #10B981; margin-right: 0.5rem;"></i>
                        현재 구독: {{ user_subscription.plan.display_name }}
                    </h3>
                    <p style="color: var(--text-body); margin: 0;">
                        만료일: {{ user_subscription.end_date|date:"Y년 m월 d일" }}
                        {% if user_subscription.auto_renew %}
                            <span style="color: #10B981; font-size: 0.875rem;">(자동 갱신)</span>
                        {% endif %}
                    </p>
                </div>
            {% endif %}
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                {% for plan in plans %}
                    <div style="border: 1px solid var(--card-border); border-radius: 12px; padding: 1.5rem; background: var(--bg-surface); position: relative; transition: all 0.3s ease;">
                        {% if plan.name == 'premium' %}
                            <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #8B5CF6, #7C3AED); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">
                                인기 플랜
                            </div>
                        {% endif %}
                        
                        <div style="text-align: center; margin-bottom: 1.5rem;">
                            <h3 style="color: var(--text-heading); margin-bottom: 0.5rem; font-size: 1.25rem;">{{ plan.display_name }}</h3>
                            <div style="margin-bottom: 0.5rem;">
                                <span style="font-size: 2rem; font-weight: 700; color: var(--btn-primary-bg);">{{ plan.price|floatformat:0 }}</span>
                                <span style="color: var(--text-secondary); margin-left: 0.25rem;">{{ plan.currency }}</span>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 0.875rem; margin: 0;">
                                {% if plan.billing_cycle == 'monthly' %}월간{% else %}연간{% endif %} 결제
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <h4 style="color: var(--text-heading); margin-bottom: 1rem; font-size: 1rem;">포함 기능</h4>
                            <ul style="list-style: none; padding: 0; margin: 0;">
                                <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                    <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                    프로젝트 {{ plan.max_projects }}개
                                </li>
                                <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                    <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                    팀원 {{ plan.max_team_members }}명
                                </li>
                                <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                    <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                    저장공간 {{ plan.max_storage_gb }}GB
                                </li>
                                {% if plan.has_priority_support %}
                                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                        <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                        우선 지원
                                    </li>
                                {% endif %}
                                {% if plan.has_advanced_analytics %}
                                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                        <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                        고급 분석
                                    </li>
                                {% endif %}
                                {% if plan.has_api_access %}
                                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                        <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                        API 접근
                                    </li>
                                {% endif %}
                                {% if plan.has_custom_branding %}
                                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem; color: var(--text-body);">
                                        <i class="fas fa-check" style="color: #10B981; margin-right: 0.5rem; width: 16px;"></i>
                                        커스텀 브랜딩
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                        
                        <div style="text-align: center;">
                            {% if user_subscription and user_subscription.plan == plan %}
                                <button class="btn btn-secondary" disabled style="width: 100%;">
                                    <i class="fas fa-check"></i>
                                    현재 플랜
                                </button>
                            {% else %}
                                <a href="{% url 'wbs:subscribe' plan.id %}" class="btn btn-primary" style="width: 100%;">
                                    <i class="fas fa-credit-card"></i>
                                    {% if plan.price == 0 %}무료 시작{% else %}구독하기{% endif %}
                                </a>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            
            {% if user_subscription %}
                <div style="margin-top: 2rem; text-align: center;">
                    <a href="{% url 'wbs:my_subscription' %}" class="btn btn-secondary">
                        <i class="fas fa-user-cog"></i>
                        내 구독 관리
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}


